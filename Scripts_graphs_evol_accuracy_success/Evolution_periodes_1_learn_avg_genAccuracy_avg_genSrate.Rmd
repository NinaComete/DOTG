---
title: |
  Evolution de la précision moyenne des connaissances (avg.genAccuracy) et du succès moyen des interactions (avg.genSrate) des agents selon leur durée d'existence (période), avec un taux de transmission maximal (tend vers 1)
---

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
library(readr)

# 200001 ----
# Importer les données
url <- "https://raw.githubusercontent.com/NinaComete/DOTG/master/200001-1-learn/average.csv"
G_200001_1_learn <- read.csv(url, header = TRUE, sep = " ")

# Trouver l'indice où avg.genAccuracy est maximale
max_index <- which.max(G_200001_1_learn$avg.genAccuracy)

# Récupérer le rang correspondant à cet indice
max_rank <- G_200001_1_learn$rank[max_index]

# Récupérer la valeur de avg.genAccuracy à ce point
max_avg_gen_accuracy <- G_200001_1_learn$avg.genAccuracy[max_index]

# Trouver l'index du point où avg.genAccuracy est maximale
max_index_accuracy <- which.max(G_200001_1_learn$avg.genAccuracy)

# Trouver l'index du point où avg.genSrate est maximale
max_index_srate <- which.max(G_200001_1_learn$avg.genSrate)

# Récupérer le rang et la valeur correspondant au max de avg.genAccuracy
max_rank_accuracy <- G_200001_1_learn$rank[max_index_accuracy]
max_value_accuracy <- G_200001_1_learn$avg.genAccuracy[max_index_accuracy]

# Récupérer le rang et la valeur correspondant au max de avg.genSrate
max_rank_srate <- G_200001_1_learn$rank[max_index_srate]
max_value_srate <- G_200001_1_learn$avg.genSrate[max_index_srate]

# Trouver l'index où la différence entre avg.genAccuracy et avg.genSrate est minimale
cross_index <- which.min(abs(G_200001_1_learn$avg.genAccuracy[max_index_accuracy] - G_200001_1_learn$avg.genSrate))

# Récupérer le rang et les valeurs d'avg.genAccuracy et avg.genSrate au point de croisement
cross_rank <- G_200001_1_learn$rank[cross_index]
cross_value_accuracy <- G_200001_1_learn$avg.genAccuracy[cross_index]
cross_value_srate <- G_200001_1_learn$avg.genSrate[cross_index]


# Tracer le graphique avec les deux courbes et les points de max annotés
library(ggplot2)

ggplot(G_200001_1_learn, aes(x = rank)) + 
  geom_line(aes(y = avg.genAccuracy), color = "red") +
  geom_line(aes(y = avg.genSrate), color = "blue") +
  geom_point(data = G_200001_1_learn[max_index_accuracy, ], aes(x = rank, y = avg.genAccuracy), color = "red", size = 3) +
  geom_point(data = G_200001_1_learn[max_index_srate, ], aes(x = rank, y = avg.genSrate), color = "blue", size = 3) +
  annotate("point", x = cross_rank, y = cross_value_accuracy, color = "black", size = 3) +
  annotate("text", 
           x = cross_rank - 10000,  # Décaler vers la gauche
           y = cross_value_accuracy + 0.01, 
           label = paste("Point de croisement :", cross_rank, "\navg.genAccuracy =", round(cross_value_accuracy, digits = 4), "\navg.genSrate =", round(cross_value_srate, digits = 4)), 
           vjust = 1.5,  # Placer l'étiquette en dessous du point
           hjust = -0.1,   # Aligner à droite par rapport au point
           color = "black", size = 3) +
  annotate("text", x = G_200001_1_learn$rank[max_index_accuracy], y = max_value_accuracy - 0.02, label = paste("Max avg.genAccuracy \nitération:", max_rank_accuracy, ", value =", round(max_value_accuracy, digits = 4)), vjust = -1.2, hjust = 0.5, color = "red", size = 3) +
  annotate("text", x = G_200001_1_learn$rank[max_index_srate], y = max_value_srate - 0.02, label = paste("Max avg.genSrate : itération ", max_rank_srate, ", value =", round(max_value_srate, digits = 4)), vjust = -1.4, hjust = 1.1, color = "blue", size = 3) +
  labs(title = "Période 200001, transmission =  1: évolution de la précision moyenne des \nconnaissances (avg.genAccuracy)  et du succès moyen des interactions (avg.genSrate)") +
  theme_minimal() +
  theme(plot.title = element_text(size = 11)) +  # Modification de la taille de la police du titre
  scale_x_continuous(limits = c(min(G_200001_1_learn$rank), max(G_200001_1_learn$rank) + 30000)) +  # Augmenter les limites de l'axe x
  scale_y_continuous(limits = c(min(G_200001_1_learn$avg.genAccuracy, G_200001_1_learn$avg.genSrate), max(G_200001_1_learn$avg.genAccuracy, G_200001_1_learn$avg.genSrate) + 0.2))  # Augmenter les limites de l'axe y



# 5001 ----
# Importer les donnees
url <- "https://raw.githubusercontent.com/NinaComete/DOTG/master/5001-1-learn/average.csv"
G_5001_1_learn <- read.csv(url, header = TRUE, sep = " ")

# Trouver l'indice oe avg.genAccuracy est maximale
max_index_accuracy <- which.max(G_5001_1_learn$avg.genAccuracy)
# Recuperer le rang correspondant e cet indice
max_rank_accuracy <- G_5001_1_learn$rank[max_index_accuracy]
# Recuperer la valeur de avg.genAccuracy en ce point
max_value_accuracy <- G_5001_1_learn$avg.genAccuracy[max_index_accuracy]

# Trouver l'indice oe avg.genSrate est maximale
max_index_srate <- which.max(G_5001_1_learn$avg.genSrate)
# Recuperer le rang correspondant e cet indice
max_rank_srate <- G_5001_1_learn$rank[max_index_srate]
# Recuperer la valeur de avg.genSrate e ce point
max_value_srate <- G_5001_1_learn$avg.genSrate[max_index_srate]

# Selectionner le dernier point de l'iteration
last_point <- tail(G_5001_1_learn, 1)

# Tracer le graphique avec les deux courbes et le dernier point annoté
ggplot(G_5001_1_learn, aes(x = rank)) +
  geom_line(aes(y = avg.genAccuracy), color = "red") +
  geom_line(aes(y = avg.genSrate), color = "blue") +
  geom_point(data = G_5001_1_learn[max_index_accuracy, ], aes(x = rank, y = avg.genAccuracy), color = "red", size = 3) +
  geom_point(data = G_5001_1_learn[max_index_srate, ], aes(x = rank, y = avg.genSrate), color = "blue", size = 3) +
  geom_point(data = last_point, aes(x = rank, y = avg.genAccuracy), color = "green", size = 3) + # Ajout du dernier point en vert
  annotate("text", x = last_point$rank, y = last_point$avg.genAccuracy - 0.02, label = paste("Dernier point :", last_point$rank, "\navg.genAccuracy =", round(last_point$avg.genAccuracy, digits = 4), "\navg.genSrate =", round(last_point$avg.genSrate, digits = 4)), vjust = 0.5, hjust = 0, color = "black", size = 3) +
  annotate("text", x = max_rank_accuracy, y = max_value_accuracy - 0.02, 
           label = paste("Max avg.genAccuracy\niteration :", max_rank_accuracy, ", value =", round(max_value_accuracy, digits = 4)), 
           vjust = 1, hjust = 0, color = "red", size = 3)+
  annotate("text", x = G_5001_1_learn$rank[max_index_srate] + 10000, y = max_value_srate - 0.02, label = paste("Max avg.genSrate\niteration  :", max_rank_srate, ", value =", round(max_value_srate, digits = 4)), vjust = -0.5, hjust = 0.5, color = "blue", size = 3) +
  labs(title = "Periode 5001, transmission =  1: evolution de la precision moyenne des \nconnaissances (avg.genAccuracy) et du succes moyen des interactions (avg.genSrate)") +
  theme_minimal() +
  theme(plot.title = element_text(size = 11), 
        axis.title.y = element_text(margin = margin(t = 20)),  # Augmenter l'espace entre l'axe y et le titre
        axis.title.x = element_text(margin = margin(t = 10)),  # Augmenter l'espace entre l'axe x et le graphique
        axis.text.x = element_text(angle = 0, hjust = 0.5),     # Rétablir les étiquettes de l'axe x à l'horizontal
        plot.margin = margin(t = 20, r = 20, b = 20, l = 20)) +  # Ajuster les marges du graphique
  scale_x_continuous(limits = c(min(G_5001_1_learn$rank), max(G_5001_1_learn$rank) + 53000), labels = function(x) format(x, scientific = FALSE)) +  # Augmenter les limites de l'axe x
  scale_y_continuous(limits = c(min(G_5001_1_learn$avg.genAccuracy, G_5001_1_learn$avg.genSrate), max(G_5001_1_learn$avg.genAccuracy, G_5001_1_learn$avg.genSrate) + 0.15)) # Augmenter les limites de l'axe y


# 10001 -----
# Importer les donnees
url <- "https://raw.githubusercontent.com/NinaComete/DOTG/master/10001-1-learn/average.csv"
G_10001_1_learn <- read.csv(url, header = TRUE, sep = " ")

# Trouver l'indice oe avg.genAccuracy est maximale
max_index_accuracy <- which.max(G_10001_1_learn$avg.genAccuracy)
# Recuperer le rang correspondant e cet indice
max_rank_accuracy <- G_10001_1_learn$rank[max_index_accuracy]
# Recuperer la valeur de avg.genAccuracy en ce point
max_value_accuracy <- G_10001_1_learn$avg.genAccuracy[max_index_accuracy]

# Trouver l'indice oe avg.genSrate est maximale
max_index_srate <- which.max(G_10001_1_learn$avg.genSrate)
# Recuperer le rang correspondant e cet indice
max_rank_srate <- G_10001_1_learn$rank[max_index_srate]
# Recuperer la valeur de avg.genSrate e ce point
max_value_srate <- G_10001_1_learn$avg.genSrate[max_index_srate]

# Selectionner le dernier point de l'iteration
last_point <- tail(G_10001_1_learn, 1)

# Tracer le graphique avec les deux courbes et le dernier point annoté
ggplot(G_10001_1_learn, aes(x = rank)) +
  geom_line(aes(y = avg.genAccuracy), color = "red") +
  geom_line(aes(y = avg.genSrate), color = "blue") +
  geom_point(data = G_10001_1_learn[max_index_accuracy, ], aes(x = rank, y = avg.genAccuracy), color = "red", size = 3) +
  geom_point(data = G_10001_1_learn[max_index_srate, ], aes(x = rank, y = avg.genSrate), color = "blue", size = 3) +
  geom_point(data = last_point, aes(x = rank, y = avg.genAccuracy), color = "green", size = 3) + # Ajout du dernier point en vert
  annotate("text", x = last_point$rank, y = last_point$avg.genAccuracy - 0.02, label = paste("Dernier point :", last_point$rank, "\navg.genAccuracy =", round(last_point$avg.genAccuracy, digits = 4), "\navg.genSrate =", round(last_point$avg.genSrate, digits = 4)), vjust = 1, hjust = 0, color = "black", size = 3) +
  annotate("text", x = max_rank_accuracy, y = max_value_accuracy - 0.02, 
           label = paste("Max avg.genAccuracy\niteration :", max_rank_accuracy, ", value =", round(max_value_accuracy, digits = 4)), 
           vjust = -0.7, hjust = 0, color = "red", size = 3)+
  annotate("text", x = G_10001_1_learn$rank[max_index_srate] + 10000, y = max_value_srate - 0.02, label = paste("Max avg.genSrate\niteration  :", max_rank_srate, ", value =", round(max_value_srate, digits = 4)), vjust = -0.5, hjust = 0, color = "blue", size = 3) +
  labs(title = "Periode 10001, transmission =  1: evolution de la precision moyenne des \nconnaissances (avg.genAccuracy) et du succes moyen des interactions (avg.genSrate)") +
  theme_minimal() +
  theme(plot.title = element_text(size = 11), 
        axis.title.y = element_text(margin = margin(t = 20)),  # Augmenter l'espace entre l'axe y et le titre
        axis.title.x = element_text(margin = margin(t = 10)),  # Augmenter l'espace entre l'axe x et le graphique
        axis.text.x = element_text(angle = 0, hjust = 0.5),     # Rétablir les étiquettes de l'axe x à l'horizontal
        plot.margin = margin(t = 20, r = 20, b = 20, l = 20)) +  # Ajuster les marges du graphique
  scale_x_continuous(limits = c(min(G_10001_1_learn$rank), max(G_10001_1_learn$rank) + 53000), labels = function(x) format(x, scientific = FALSE)) +  # Augmenter les limites de l'axe x
  scale_y_continuous(limits = c(min(G_10001_1_learn$avg.genAccuracy, G_10001_1_learn$avg.genSrate), max(G_10001_1_learn$avg.genAccuracy, G_10001_1_learn$avg.genSrate) + 0.15)) # Augmenter les limites de l'axe y


# 20001 -----
library(ggplot2)

# Importer les donnees
url <- "https://raw.githubusercontent.com/NinaComete/DOTG/master/20001-1-learn/average.csv"
G_20001_1_learn <- read.csv(url, header = TRUE, sep = " ")

# Trouver l'indice oe avg.genAccuracy est maximale
max_index_accuracy <- which.max(G_20001_1_learn$avg.genAccuracy)
# Recuperer le rang correspondant e cet indice
max_rank_accuracy <- G_20001_1_learn$rank[max_index_accuracy]
# Recuperer la valeur de avg.genAccuracy en ce point
max_value_accuracy <- G_20001_1_learn$avg.genAccuracy[max_index_accuracy]

# Trouver l'indice oe avg.genSrate est maximale
max_index_srate <- which.max(G_20001_1_learn$avg.genSrate)
# Recuperer le rang correspondant e cet indice
max_rank_srate <- G_20001_1_learn$rank[max_index_srate]
# Recuperer la valeur de avg.genSrate e ce point
max_value_srate <- G_20001_1_learn$avg.genSrate[max_index_srate]

# Selectionner le dernier point de l'iteration
last_point <- tail(G_20001_1_learn, 1)

# Tracer le graphique avec les deux courbes et le dernier point annoté
ggplot(G_20001_1_learn, aes(x = rank)) +
  geom_line(aes(y = avg.genAccuracy), color = "red") +
  geom_line(aes(y = avg.genSrate), color = "blue") +
  geom_point(data = G_20001_1_learn[max_index_accuracy, ], aes(x = rank, y = avg.genAccuracy), color = "red", size = 3) +
  geom_point(data = G_20001_1_learn[max_index_srate, ], aes(x = rank, y = avg.genSrate), color = "blue", size = 3) +
  geom_point(data = last_point, aes(x = rank, y = avg.genAccuracy), color = "green", size = 3) + # Ajout du dernier point en vert
  annotate("text", x = last_point$rank, y = last_point$avg.genAccuracy - 0.02, label = paste("Dernier point :", last_point$rank, "\navg.genAccuracy =", round(last_point$avg.genAccuracy, digits = 4), "\navg.genSrate =", round(last_point$avg.genSrate, digits = 4)), vjust = 1, hjust = 0, color = "black", size = 3) +
  annotate("text", x = max_rank_accuracy, y = max_value_accuracy - 0.02, 
           label = paste("Max avg.genAccuracy\niteration :", max_rank_accuracy, ", value =", round(max_value_accuracy, digits = 4)), 
           vjust = -0.5, hjust = -0.1, color = "red", size = 3) +
  annotate("text", x = G_20001_1_learn$rank[max_index_srate] + 10000, y = max_value_srate - 0.02, label = paste("Max avg.genSrate\niteration  :", max_rank_srate, ", value =", round(max_value_srate, digits = 4)), vjust = -0.5, hjust = 0.2, color = "blue", size = 3) +
  labs(title = "Periode 20001, transmission =  1: evolution de la precision moyenne des \nconnaissances (avg.genAccuracy) et du succes moyen des interactions (avg.genSrate)") +
  theme_minimal() +
  theme(plot.title = element_text(size = 11), 
        axis.title.y = element_text(margin = margin(t = 20)),  # Augmenter l'espace entre l'axe y et le titre
        axis.title.x = element_text(margin = margin(t = 10)),  # Augmenter l'espace entre l'axe x et le graphique
        axis.text.x = element_text(angle = 0, hjust = 0.5),     # Aligner horizontalement les étiquettes de l'axe x
        plot.margin = margin(t = 20, r = 20, b = 20, l = 20)) +  # Ajuster les marges du graphique
  scale_x_continuous(limits = c(min(G_20001_1_learn$rank), max(G_20001_1_learn$rank) + 53000), 
                     labels = function(x) format(x, scientific = FALSE)) +  # Modifier le format de l'axe x
  scale_y_continuous(limits = c(min(G_20001_1_learn$avg.genAccuracy, G_20001_1_learn$avg.genSrate), max(G_20001_1_learn$avg.genAccuracy, G_20001_1_learn$avg.genSrate) + 0.15)) # Augmenter les limites de l'axe y


```


