---
title : "Tableau des durées de vies, précisions moyennes (accuracy) des connaissances et succès moyen des interactions dans les populations d'agents où la transmission est aléatoire (random) et effective (entre générations)"
  
output:
  html_document
---

```{r, echo=FALSE, warning=FALSE}

library(ggplot2)
library(readr)
library(knitr)
library(kableExtra)
library(dplyr)

create_summary_table <- function() {
  # Liste des URLs des fichiers
  urls <- c("https://raw.githubusercontent.com/NinaComete/DOTG/master/5001-1-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/5001-0.8-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/5001-0.6-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/5001-0.4-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/5001-0.2-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/10001-1-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/10001-0.8-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/10001-0.6-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/10001-0.4-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/10001-0.2-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/20001-1-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/20001-0.8-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/20001-0.6-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/20001-0.4-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/20001-0.2-random/average.csv")
  
  # Initialisation des vecteurs
  duree_de_vie <- c()
  max_avg_gen_accuracies <- c()
  max_avg_gen_accuracy_ranks <- c()
  max_avg_gen_srates <- c()
  max_avg_gen_srate_ranks <- c()
  last_ranks <- c()
  last_value_accuracies <- c()
  last_value_srates <- c()
  
  # Boucle sur chaque URL
  for (url in urls) {
    # Charger les données
    data <- read.csv(url, header = TRUE, sep = " ")
    
    # Trouver l'indice où avg.genAccuracy est maximale
    max_index_accuracy <- which.max(data$avg.genAccuracy)
    max_value_accuracy <- data$avg.genAccuracy[max_index_accuracy]
    max_rank_accuracy <- data$rank[max_index_accuracy]
    
    # Trouver l'indice où avg.genSrate est maximale
    max_index_srate <- which.max(data$avg.genSrate)
    max_value_srate <- data$avg.genSrate[max_index_srate]
    max_rank_srate <- data$rank[max_index_srate]
    
    # Trouver l'indice de la dernière itération
    last_index <- nrow(data)
    last_value_accuracy <- data$avg.genAccuracy[last_index]
    last_value_srate <- data$avg.genSrate[last_index]
    
    # Calcul de l'espérance de vie en fonction de l'URL
    if (grepl("5001", url)) {
      duree_de_vie_actuelle <- 5001 + (5001/2)
    } else if (grepl("10001", url)) {
      duree_de_vie_actuelle <- 10001 + (10001/2)
    } else if (grepl("20001", url)) {
      duree_de_vie_actuelle <- 20001 + (20001/2)
    }
    
    # Ajouter les informations aux vecteurs
    duree_de_vie <- c(duree_de_vie, duree_de_vie_actuelle)
    max_avg_gen_accuracies <- c(max_avg_gen_accuracies, max_value_accuracy)
    max_avg_gen_accuracy_ranks <- c(max_avg_gen_accuracy_ranks, max_rank_accuracy)
    max_avg_gen_srates <- c(max_avg_gen_srates, max_value_srate)
    max_avg_gen_srate_ranks <- c(max_avg_gen_srate_ranks, max_rank_srate)
    last_ranks <- c(last_ranks, data$rank[last_index])
    last_value_accuracies <- c(last_value_accuracies, last_value_accuracy)
    last_value_srates <- c(last_value_srates, last_value_srate)
  }
  
  # Création du dataframe
  tableau_durees_vies_random <- data.frame(duree_de_vie = duree_de_vie,
                                        max_avg_gen_accuracy = max_avg_gen_accuracies,
                                        max_avg_gen_accuracy_rank = max_avg_gen_accuracy_ranks,
                                        max_avg_gen_srate = max_avg_gen_srates,
                                        max_avg_gen_srate_rank = max_avg_gen_srate_ranks,
                                        last_rank = last_ranks,
                                        last_value_accuracy = last_value_accuracies,
                                        last_value_srate = last_value_srates)
  
  return(tableau_durees_vies_random)
}

# Créer le tableau récapitulatif
tableau_durees_vies_random <- create_summary_table()

# Affichage du tableau récapitulatif avec une taille de police réduite
kable(tableau_durees_vies_random, format = "html", align = "c", 
      col.names = c("Durée de vie", 
                    "Max précision moyenne (avg.genAccuracy)", 
                    "Rang auquel la précision moyenne maximale est atteinte",
                    "Max succès moyen (avg.genSrate)", 
                    "Rang auquel le succès moyen maximal est atteint",
                    "Dernier rang", 
                    "Precision atteinte au dernier rang", 
                    "Succès atteint au dernier rang"),
      row.names = FALSE, 
      #caption = "Tableau récapitulatif des résultats",
      booktabs = TRUE) %>%
  kable_styling(full_width = FALSE, font_size = 10)  # Réduire la taille de police à 12 points


```

