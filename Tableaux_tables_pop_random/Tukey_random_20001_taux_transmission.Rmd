---
title : "Significativité des différences entre les valeurs maximales de précision moyenne (max_avg_gen_accuracy) des connaissances respectivement atteintes dans les  populations d'agents dont la durée de vie moyenne est de 30001 itérations (période = 20001) selon le taux de transmission aléatoire (random) ou effectif (0.2 ; 0.4 ; 0.6 ; 0.7 ; 0.8 ; 1"
output:
  html_document
    
---

```{r, echo=FALSE, results='asis', warning=FALSE}

library(ggplot2)
library(readr)
library(knitr)
library(kableExtra)
library(dplyr)

create_summary_table <- function() {
  # Liste des URLs des fichiers
  urls <- c("https://raw.githubusercontent.com/NinaComete/DOTG/master/20001-1-learn/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/20001-0.8-learn/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/20001-0.6-learn/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/20001-0.4-learn/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/20001-0.2-learn/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/20001-1-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/20001-0.8-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/20001-0.6-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/20001-0.4-random/average.csv",
            "https://raw.githubusercontent.com/NinaComete/DOTG/master/20001-0.2-random/average.csv")
  
  # Initialisation des vecteurs
  taux_transmission <- c()
  max_avg_gen_accuracies <- c()
  max_avg_gen_accuracy_ranks <- c()
  max_avg_gen_srates <- c()
  max_avg_gen_srate_ranks <- c()
  last_ranks <- c()
  last_value_accuracies <- c()
  last_value_srates <- c()
  
  # Boucle sur chaque URL
  for (url in urls) {
    # Charger les donn?es
    data <- read.csv(url, header = TRUE, sep = " ")
    
    # Trouver l'indice o? avg.genAccuracy est maximale
    max_index_accuracy <- which.max(data$avg.genAccuracy)
    max_value_accuracy <- data$avg.genAccuracy[max_index_accuracy]
    max_rank_accuracy <- data$rank[max_index_accuracy]
    
    # Trouver l'indice o? avg.genSrate est maximale
    max_index_srate <- which.max(data$avg.genSrate)
    max_value_srate <- data$avg.genSrate[max_index_srate]
    max_rank_srate <- data$rank[max_index_srate]
    
    # Trouver l'indice de la derni?re it?ration
    last_index <- nrow(data)
    last_value_accuracy <- data$avg.genAccuracy[last_index]
    last_value_srate <- data$avg.genSrate[last_index]
    
    # Calcul du taux de transmission en fonction de l'URL
    if (grepl("-1-learn", url)) {
      taux_transmission_current <- "1"
    } else if (grepl("-0.8-learn", url)) {
      taux_transmission_current <- "0.8"
    } else if (grepl("-0.6-learn", url)) {
      taux_transmission_current <- "0.6"
    } else if (grepl("-0.4-learn", url)) {
      taux_transmission_current <- "0.4"
    } else if (grepl("-0.2-learn", url)) {
      taux_transmission_current <- "0.2"
    } else if (grepl("-random", url)) {
      taux_transmission_current <- "random"
    } 
    
    # Ajouter les informations aux vecteurs
    taux_transmission <- c(taux_transmission, taux_transmission_current)
    max_avg_gen_accuracies <- c(max_avg_gen_accuracies, max_value_accuracy)
    max_avg_gen_accuracy_ranks <- c(max_avg_gen_accuracy_ranks, max_rank_accuracy)
    max_avg_gen_srates <- c(max_avg_gen_srates, max_value_srate)
    max_avg_gen_srate_ranks <- c(max_avg_gen_srate_ranks, max_rank_srate)
    last_ranks <- c(last_ranks, data$rank[last_index])
    last_value_accuracies <- c(last_value_accuracies, last_value_accuracy)
    last_value_srates <- c(last_value_srates, last_value_srate)
  }
  
  # Creation du dataframe
  tableau_20001_transmission <- data.frame(taux_transmission = taux_transmission,
                                        max_avg_gen_accuracy = max_avg_gen_accuracies,
                                        max_avg_gen_accuracy_rank = max_avg_gen_accuracy_ranks,
                                        max_avg_gen_srate = max_avg_gen_srates,
                                        max_avg_gen_srate_rank = max_avg_gen_srate_ranks,
                                        last_rank = last_ranks,
                                        last_value_accuracy = last_value_accuracies,
                                        last_value_srate = last_value_srates)
  
  return(tableau_20001_transmission)
}

# Creer le tableau r?capitulatif
tableau_20001_transmission <- create_summary_table()


# ANOVA pour tableau_20001_transmission  ----
model_20001_transmission <- aov(max_avg_gen_accuracy ~ taux_transmission, data = tableau_20001_transmission)

# summary(model_20001_transmission)

# Obtenir la p-value de l'ANOVA
p_value_anova <- anova(model_20001_transmission)["taux_transmission", "Pr(>F)"]

# Afficher la p-value
# print(p_value_anova)

library(kableExtra)
# Effectuer le test de Tukey
tukey_test_20001_transmission <- TukeyHSD(model_20001_transmission)

# Afficher les résultats du test de Tukey avec kable() en format HTML
tukey_results <- as.data.frame(tukey_test_20001_transmission$`taux_transmission`)
colnames(tukey_results) <- c("Différence entre les moyennes des groupes comparés (diff)", 
                             "Limite inférieure de l'intervalle de confiance à 95% pour la différence entre les moyennes", 
                             "Limite supérieure de l'intervalle de confiance à 95% pour la différence entre les moyennes", 
                             "Probabilité ajustée pour chaque comparaison (significatif si <0.05)")

kable(tukey_results, format = "html", caption = "Résultats du test de Tukey (HSD) appliqué aux valeurs maximales de précision moyenne des connaissances atteintes dans les différentes populations où la durée de vie moyenne des agents est de 30001 itérations (péride = 20001) et selon le taux de transmission aléatoire (random) et effectif (0.2 ; 0.4 ; 0.6 ; 0.8 ; 1)",
      col.width = "100px", text.font = "10pt")
 
```


